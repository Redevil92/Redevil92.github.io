import{r as p,b as K,A as X,d as Y,i as j,N as q,w as z,j as P,o as m,c as h,a as r,H as v,O as M,P as b,I as U,F as A,m as Q,Q as D,K as W,g as y,l as F,L as G,k as J,y as Z,R as _,n as V,f as ee,S as te,U as se,V as ie,W as oe,p as ae,h as le,_ as ne}from"./index-8lyaWh5H.js";import{a as re,F as de}from"./FavouritesPanel-pBcxeB_N.js";function ue(i){const a=p(!1),n=u=>{var d;const l=(d=i.value)==null?void 0:d.getBoundingClientRect();l&&u.clientX<l.x+l.width&&u.clientX>l.x&&u.clientY<l.y+l.height&&u.clientY>l.y?a.value=!0:a.value=!1};return K(()=>{window.addEventListener("mousemove",n)}),X(()=>{window.removeEventListener("mousemove",n)}),{isMouseOver:a}}const I=i=>(ae("data-v-46b5cdcc"),i=i(),le(),i),ce=["id"],me={class:"flex"},he=I(()=>r("div",{class:"mdi mdi-folder path-padding"},null,-1)),pe=I(()=>r("span",{class:"mdi mdi-folder path-padding"},null,-1)),fe=I(()=>r("span",{class:"mdi mdi-chevron-right path-padding"},null,-1)),ge=["onClick"],ve={key:0,class:"mdi mdi-chevron-right path-padding"},De={class:"flex-start"},ye=Y({__name:"FolderItem",props:{itemDialog:{type:Object,required:!0},height:{type:Number,required:!0}},setup(i){var C;const a=i,n=j(),u=p(null),l=p(null),d=p(!1),c=p((C=a.itemDialog)==null?void 0:C.path),{moveFilesInFolder:O,setFilesToMove:Fe}=q(),{isMouseOver:R}=ue(u);z(()=>a.itemDialog,(e,t)=>{(e==null?void 0:e.path)!==(t==null?void 0:t.path)&&(t!=null&&t.path)&&(c.value=t.path)});const L=P(function(){return n.dragginPath!==""}),N=e=>{a.itemDialog.selectedFilesPath=e},$=async e=>{if(await ee.isDir(e))f(e);else{const s={path:e,coordinates:{x:0,y:0},isSelected:!0};n.createItemDialog(s)}},w=async(e,t=!1)=>{e.event.preventDefault(),e.event.stopPropagation();const s=e.event,o=t?[te(s,e.filePath),se(s,e.filePath),await ie(e.filePath,!1,!1,!1)]:[...await oe([e.filePath],e.event)];n.setActionMenu({show:!0,paths:[e.filePath],position:{x:s.clientX,y:s.clientY},customLayout:o})},x=()=>{var e;k(!1),c.value=(e=a.itemDialog)==null?void 0:e.path},B=async e=>{var t;O(e,((t=a.itemDialog)==null?void 0:t.path)||"")},f=e=>{S(),n.updateItemDialogPath({newPath:e,itemDialog:a.itemDialog}),c.value=e},E=e=>{n.renameFile(e.newName,e.oldName),T()},k=async e=>{e&&l.value&&setTimeout(()=>{var t,s;(t=l.value)==null||t.focus(),(s=l.value)==null||s.select()},10),d.value=e},T=()=>{n.refreshAllItemDialogFiles(),n.fetchDesktopItems()},g=P(function(){var e;return(e=a.itemDialog)==null?void 0:e.path.split("/")}),H=(e,t)=>{if(e===void 0)return"";let s="";for(let o=0;o<=t;o++)o!==0&&(s+="/"),s+=e[o];return s},S=()=>{n.setFocusedItemDialog(a.itemDialog||null)};return(e,t)=>i.itemDialog?(m(),h("div",{key:0,onClick:S,onContextmenu:t[8]||(t[8]=D(s=>{var o;return w({event:s,filePath:((o=i.itemDialog)==null?void 0:o.path)||""},!0)},["right"])),class:"droppable",id:i.itemDialog.path},[r("div",{style:V(`height:${i.height-5}px; position:relative`)},[r("div",{class:"folder-actions",onClick:t[4]||(t[4]=s=>d.value=!0)},[v(r("div",me,[he,v(r("input",{ref_key:"fullPathInputRef",ref:l,class:"no-style-input path-input","onUpdate:modelValue":t[0]||(t[0]=s=>c.value=s),onKeyup:[t[1]||(t[1]=b(s=>f(c.value||""),["enter"])),b(x,["esc"])],onBlur:x,type:"text"},null,544),[[U,c.value]])],512),[[M,d.value]]),g.value?v((m(),h("div",{key:0,class:"flex",onMousedn:t[3]||(t[3]=s=>k(!0))},[pe,fe,(m(!0),h(A,null,Q(g.value,(s,o)=>(m(),h("div",{key:"path-"+o+"-"+s,class:"flex"},[r("div",{class:"path-item path-padding",onMousedown:t[2]||(t[2]=D(()=>{},["stop"])),onClick:D(Ie=>f(H(g.value,o)),["stop"])},W(s),41,ge),g.value.length>o+1?(m(),h("span",ve)):y("",!0)]))),128))],544)),[[M,!d.value]]):y("",!0)]),r("div",De,[F(re,{height:i.height-35,onOnFavouriteSelect:t[5]||(t[5]=s=>f(s))},null,8,["height"]),F(_,{dropPath:i.itemDialog.path,style:{"flex-grow":"1","overflow-x":"auto",position:"relative","padding-bottom":"30px"}},{default:G(()=>[r("div",{onMousedown:t[7]||(t[7]=s=>d.value=!1),onDrop:B,class:J(["folder-item-list",{"folder-item-list-drag-over":L.value&&Z(R)}]),ref_key:"folderContentRef",ref:u},[F(de,{itemsList:i.itemDialog.filesPath,canRename:!0,showProperties:!0,height:i.height-50-20,isFocused:i.itemDialog.isFocused,onOnDoubleClick:$,onOnRightClick:t[6]||(t[6]=s=>w(s,!1)),onRenameFileHandler:E,onOnSelectedItemsChange:N},null,8,["itemsList","height","isFocused"])],34)]),_:1},8,["dropPath"])])],4)],40,ce)):y("",!0)}}),ke=ne(ye,[["__scopeId","data-v-46b5cdcc"]]);export{ke as default};
